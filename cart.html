<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Your Shopping Cart - Gloriva Lighting</title>

    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/aos@2.3.1/dist/aos.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Montserrat", sans-serif;
        background: #f8f9fa;
      }
      .cart-item {
        transition: all 0.3s;
      }
      .cart-item:hover {
        background: #f1f1f1;
      }
      .quantity-control {
        display: flex;
        align-items: center;
        background: #fff;
        border-radius: 50px;
        overflow: hidden;
        width: fit-content;
      }
      .quantity-btn {
        width: 40px;
        height: 40px;
        border: none;
        background: #f8f9fa;
      }
      .quantity-input {
        width: 60px;
        text-align: center;
        border: none;
        font-weight: 600;
      }

      #toast {
        position: fixed;
        top: 100px;
        right: 20px;
        min-width: 300px;
        padding: 16px 24px;
        background: #28a745;
        color: white;
        border-radius: 8px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        z-index: 1050;
        transform: translateX(120%);
        transition: transform 0.4s ease;
      }
      #toast.show {
        transform: translateX(0);
      }
      #toast.error {
        background: #dc3545;
      }

      .empty-cart {
        text-align: center;
        padding: 100px 20px;
      }
      .empty-cart i {
        font-size: 80px;
        color: #ddd;
      }
    </style>
  </head>
  <body>
    <nav
      class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top"
    >
      <div class="container">
        <a class="navbar-brand font-weight-bold" href="index.html">
          <img src="Gloriva Lighting.png" alt="" width="40" class="mr-2" />
          Gloriva Lighting
        </a>
        <div class="ml-auto">
          <a
            href="cart.html"
            class="position-relative mx-3 text-dark cart-toggle"
          >
            <i class="fas fa-shopping-cart fa-lg"></i>
            <span
              class="badge badge-primary position-absolute count"
              style="top: -8px; right: -10px; font-size: 11px"
              >0</span
            >
          </a>
        </div>
      </div>
    </nav>

    <section class="cart-section py-5" style="margin-top: 100px">
      <div class="container">
        <h1 class="text-center display-5 fw-bold mb-5">Your Shopping Cart</h1>

        <div class="row">
          <div class="col-lg-8">
            <div
              id="cart-items-container"
              class="bg-white rounded shadow-sm"
            ></div>

            <div class="empty-cart" id="empty-cart">
              <i class="fas fa-shopping-cart"></i>
              <h3 class="mt-4">Your cart is empty</h3>
              <p class="text-muted lead">
                Add items from your wishlist or browse products.
              </p>
              <a href="wishlist.html" class="btn btn-warning btn-lg mr-3"
                >View Wishlist</a
              >
              <a
                href="index.html#products"
                class="btn btn-outline-secondary btn-lg"
                >Continue Shopping</a
              >
            </div>
          </div>

          <div class="col-lg-4">
            <div
              class="bg-white rounded shadow-sm p-4 sticky-top"
              style="top: 100px"
              id="cart-summary"
              style="display: none"
            >
              <h4 class="fw-bold mb-4">Order Summary</h4>
              <div id="summary-lines"></div>
              <hr />
              <div class="d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Total</h5>
                <h4 class="text-warning mb-0" id="cart-total">₹0</h4>
              </div>
              <button
                class="btn btn-warning btn-lg w-100 mt-4"
                id="checkout-btn"
                disabled
              >
                Proceed to Checkout
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div id="toast"><strong id="toast-message"></strong></div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.1/dist/aos.js"></script>

    <script>
      $(document).ready(function () {
        AOS.init();

        function loadCart() {
          const cart = JSON.parse(localStorage.getItem("cart") || "[]");
          const container = $("#cart-items-container");
          const summary = $("#summary-lines");
          const totalEl = $("#cart-total");
          const checkoutBtn = $("#checkout-btn");

          container.empty();
          summary.empty();

          if (cart.length === 0) {
            $("#empty-cart").show();
            $("#cart-summary").hide();
            updateCartBadge();
            return;
          }

          $("#empty-cart").hide();
          $("#cart-summary").show();

          let subtotal = 0;

          cart.forEach((item, index) => {
            subtotal += item.price * item.quantity;

            const itemHTML = `
            <div class="cart-item p-4 border-bottom" data-index="${index}">
              <div class="row align-items-center">
                <div class="col-md-2">
                  <img src="${item.image}" alt="${
              item.name
            }" class="img-fluid rounded" style="height:120px; object-fit:cover;">
                </div>
                <div class="col-md-5">
                  <h5>${item.name}</h5>
                </div>
                <div class="col-md-3">
                  <div class="quantity-control">
                    <button class="quantity-btn minus">-</button>
                    <input type="number" class="quantity-input" value="${
                      item.quantity
                    }" min="1">
                    <button class="quantity-btn plus">+</button>
                  </div>
                </div>
                <div class="col-md-2 text-right">
                  <p class="fw-bold">₹${(
                    item.price * item.quantity
                  ).toLocaleString()}</p>
                  <a href="#" class="text-danger remove-item"><i class="fas fa-times"></i> Remove</a>
                </div>
              </div>
            </div>
          `;
            container.append(itemHTML);
          });

          const tax = Math.round(subtotal * 0.08);
          const total = subtotal + tax;

          summary.append(`
          <div class="d-flex justify-content-between mb-2"><span>Subtotal</span><span>₹${subtotal.toLocaleString()}</span></div>
          <div class="d-flex justify-content-between mb-2"><span>Shipping</span><span class="text-success">Free</span></div>
          <div class="d-flex justify-content-between mb-3"><span>Tax</span><span>₹${tax.toLocaleString()}</span></div>
        `);

          totalEl.text(`₹${total.toLocaleString()}`);
          checkoutBtn.prop("disabled", false);
          updateCartBadge();
        }

        // Quantity change
        $(document).on("click", ".quantity-btn", function () {
          const input = $(this).siblings(".quantity-input");
          let val = parseInt(input.val());
          if ($(this).hasClass("plus")) val++;
          else if (val > 1) val--;
          input.val(val);

          const index = $(this).closest(".cart-item").data("index");
          let cart = JSON.parse(localStorage.getItem("cart") || "[]");
          cart[index].quantity = val;
          localStorage.setItem("cart", JSON.stringify(cart));
          loadCart();
        });

        // Remove item
        $(document).on("click", ".remove-item", function (e) {
          e.preventDefault();
          const index = $(this).closest(".cart-item").data("index");
          let cart = JSON.parse(localStorage.getItem("cart") || "[]");
          const removed = cart.splice(index, 1);
          localStorage.setItem("cart", JSON.stringify(cart));
          showToast(`"${removed[0].name}" removed from cart`);
          loadCart();
        });

        function updateCartBadge() {
          let cart = JSON.parse(localStorage.getItem("cart") || "[]");
          let total = cart.reduce((s, i) => s + i.quantity, 0);
          $(".cart-toggle .count").text(total || 0);
        }

        function showToast(msg) {
          $("#toast-message").text(msg);
          $("#toast").addClass("show");
          setTimeout(() => $("#toast").removeClass("show"), 3000);
        }

        loadCart();
      });
    </script>
  </body>
</html>
